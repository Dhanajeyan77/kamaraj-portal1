import os
import psycopg2
from dotenv import load_dotenv

load_dotenv()

def populate_universal_test_cases():
    database_url = os.getenv('DATABASE_URL')
    if not database_url:
        print("❌ ERROR: DATABASE_URL is not set.")
        return

    # FORMATTING RULES:
    # 1. Booleans are "true" / "false" (JSON standard)
    # 2. Strings are double-quoted '"example"'
    # 3. Arrays are "[1, 2, 3]"
    
    test_cases = {
        # Math & Logic (91-105)
        91: [("121", "true"), ("-121", "false"), ("10", "false")],
        92: [("6", "true"), ("28", "true"), ("496", "true"), ("12", "false")],
        93: [("153", "true"), ("370", "true"), ("9474", "true"), ("123", "false")],
        94: [("2", "true"), ("7", "true"), ("10", "false"), ("1", "false")],
        95: [("10", "[2, 3, 5, 7]"), ("20", "[2, 3, 5, 7, 11, 13, 17, 19]")],
        96: [("5", "120"), ("0", "1"), ("10", "3628800")],
        97: [("0", "0"), ("1", "1"), ("6", "8"), ("10", "55")],
        98: [("48, 18", "6"), ("100, 10", "10"), ("7, 3", "1")],
        99: [("12, 15", "60"), ("4, 6", "12"), ("10, 5", "10")],
        100: [("1011", "11"), ("1111", "15"), ("100", "4")],
        101: [("13", '"1101"'), ("8", '"1000"'), ("0", '"0"')],
        102: [("145", "true"), ("1", "true"), ("123", "false")],
        103: [("123", "321"), ("-123", "-321"), ("120", "21")],
        104: [("2000", "true"), ("1900", "false"), ("2024", "true")],
        105: [("4, 2", "6"), ("5, 1", "5")],

        # Strings (106-120)
        106: [('"hello"', '"olleh"'), ('"code"', '"edoc"')],
        107: [('"silent", "listen"', "true"), ('"rat", "car"', "false")],
        108: [('"Hello"', '{"vowels": 2, "consonants": 3}')],
        109: [('"leetcode"', '"l"'), ('"aabb"', "null")],
        110: [('"aaabbc"', '"a3b2c1"')],
        111: [('"programming"', '"progamin"')],
        112: [('["flower", "flow", "flight"]', '"fl"')],
        113: [('"abcde", "cdeab"', "true")],
        114: [('"()[]{}"', "true"), ('"(]"', "false")],
        115: [('"42"', "42"), ('"   -42"', "-42")],
        116: [('"the sky is blue"', '"blue is sky the"')],
        117: [("[3, 5, 1, 9]", '{"max": 9, "min": 1}')],
        118: [("[10, 5, 10, 8]", "8")],
        119: [("[0,1,0,3,12]", "[1,3,12,0,0]")],
        120: [("[1,2,3,4,5], 2", "[4,5,1,2,3]")],

        # Arrays & Matrix (121-135)
        121: [("[3,0,1]", "2")],
        122: [("[1,2,2,1], [2,2]", "[2]")],
        123: [("[2,7,11,15], 9", "[0,1]")],
        124: [("[-1,0,3,5,9,12], 9", "4")],
        125: [("[1,1,2]", "2")],
        126: [("[[1,2],[3,4]]", "[[1,3],[2,4]]")],
        127: [("[[1,2,3],[4,5,6],[7,8,9]]", "[1,2,3,6,9,8,7,4,5]")],
        128: [("[[1,3,5,7],[10,11,16,20]], 3", "true")],
        129: [("[1,1,1], 2", "2")],
        130: [("[-2,1,-3,4,-1,2,1,-5,4]", "6")],
        131: [("[7,1,5,3,6,4]", "5")],
        132: [("[3,2,3]", "3")],
        133: [("[[1,3],[2,6],[8,10]]", "[[1,6],[8,10]]")],
        134: [("[1,2,3,4]", "[24,12,8,6]")],
        135: [("[[1,1,1],[1,0,1],[1,1,1]]", "[[1,0,1],[0,0,0],[1,0,1]]")],

        # Advanced Logic (136-150)
        136: [("2.0, 10", "1024.0")],
        137: [("3", '["((()))","(()())","(())()","()(())","()()()"]') ],
        138: [("3", "3"), ("5", "8")],
        139: [("[1,2]", "[[1,2],[2,1]]")],
        140: [("[1,2]", "[[],[1],[2],[1,2]]")],
        141: [("[['A','B'],['C','D']], 'AC'", "true")],
        142: [("[38,27,43,3]", "[3,27,38,43]")],
        143: [("[10,80,30,90,40]", "[10,30,40,80,90]")],
        144: [("[4,5,6,7,0,1,2], 0", "4")],
        145: [("[3,2,1,5,6,4], 2", "5")],

        # Linked Lists & Collections (146-160)
        146: [('"1->2->3"', '"3->2->1"')],
        147: [('"1->2->3->2"', "true")],
        148: [('"1->3, 2->4"', '"1->2->3->4"')],
        149: [('"1->2->3->4", 2', '"1->2->4"')],
        150: [('"1->2->3->4->5"', "3")],
        151: [('"1->2->2->1"', "true")],
        152: [('"A:[1,2,3], B:[4,3]"', "3")],
        153: [('"(2->4->3) + (5->6->4)"', '"7->0->8"')],
        154: [('"Node 5 in 4->5->1->9"', '"4->1->9"')],
        155: [('"4->2->1->3"', '"1->2->3->4"')],
        156: [('"Push 5, Push 10, Pop"', "10")],
        157: [('"Enqueue 1, Dequeue"', "1")],
        158: [('"Push 3, Push 2, GetMin"', "2")],
        159: [("[4, 5, 2, 10]", "[5, 10, 10, -1]")],
        160: [('"Push 1, Push 2, Pop"', "1")],

        # Trees, Graphs & DP (161-180)
        161: [('["2","1","+","3","*"]', "9")],
        162: [("[73,74,75,71]", "[1,1,0,0]")],
        163: [('"[{()}]"', "true")],
        164: [('"Stack:[3,1,2]"', '"Stack:[3,2,1]"')],
        165: [("[1,3,-1,-3,5], 3", "[3,3,5]")],
        166: [("[1,null,2,3]", "[1,3,2]")],
        167: [("[1,2,3]", '"Pre: 1,2,3 | Post: 2,3,1"')],
        168: [("[3,9,20,null,null,15,7]", "3")],
        169: [("[3,9,20]", "[[3],[9,20]]")],
        170: [("[4,2,7,1,3,6,9]", "[4,7,2,9,6,3,1]")],
        171: [("[1,2,2,3,4,4,3]", "true")],
        172: [('"Root:4, Target:2"', '"Node 2"')],
        173: [("[2,1,3]", "true")],
        174: [('"root=3, p=5, q=1"', "3")],
        175: [("[3,9,20,null,null,15,7]", "true")],
        176: [('"Grid: [[1,1,0],[1,1,0],[0,0,1]]"', "2")],
        177: [('"Image:[[1,1,1],[1,1,0]], (1,1), 2"', '"[[2,2,2],[2,2,0]]"')],
        178: [("[1,2,5], 11", "3")],
        179: [("[10,9,2,5,3,7,101,18]", "4")],
        180: [("2, [[1,0]]", "true")],
    }

    try:
        conn = psycopg2.connect(database_url)
        cursor = conn.cursor()
        cursor.execute("DELETE FROM test_cases") # Clear old Python-only data

        for q_id, cases in test_cases.items():
            for inp, out in cases:
                cursor.execute("""
                    INSERT INTO test_cases (question_id, input_data, expected_output)
                    VALUES (%s, %s, %s)
                """, (q_id, inp, out))

        conn.commit()
        print("✅ Universal (Py/Java) Test Cases successfully loaded!")

    except Exception as e:
        print(f"❌ Error: {e}")
    finally:
        if conn:
            cursor.close()
            conn.close()

if __name__ == "__main__":
    populate_universal_test_cases()